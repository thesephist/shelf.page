<header>
    <nav class="split">
        <div class="left">
            <a href="/">Shelf.page</a>
        </div>
        <div class="right">
            {{#if currentUser}}
            <a href="/user/logout">Log out</a>
            {{else}}
            <a href="/user/signup">Get your own shelf &rarr;</a>
            {{/if}}
        </div>
    </nav>
</header>

<div class="hero">
    <h1>
        <span class="user-display-name"
              data-o-type="object"
              data-l-key-display_name
              data-i-editable-without-remove
              >{{display_name}}</span>'s shelf.page
    </h1>
    <p class="bio"
       data-o-type="object"
       data-l-key-bio
       data-i-editable-without-remove
       >{{bio}}</p>
</div>

<article>
    {{#if isPageAuthor}}
    <div class="instructions">
        <p><strong>Customize this page!</strong></p>
        <p>
        Parts of this page are <em>editable</em>!
        (<a href="#" id="highlightEditables">Click here</a> to see which parts.)
        </p>
        <p>
        Tap on any editable part of the page to update and remove
        things, and drag to reorder links. You can share your page with friends with your link,
        <a href="https://shelf.page/{{currentUser.details.username}}"
           target="_blank">
            shelf.page/{{currentUser.details.username}}
        </a>.
        </p>
        <p>
        When others visit this page, the links you add below will be clickable.
        (You can also try it yourself by opening a private browsing tab.)
        </p>
    </div>
    {{/if}}

    <p class="preamble">
    Here's what
    <span id="display-name-reflect">{{display_name}}</span>
    has been reading and recommending, about...
    </p>

    <div data-o-key="topics" data-o-type="list">
        {{#for topic in topics}}
        <section data-o-type="object"
                 data-l-key-name>
            <div class="topic-header split">
                <div class="left">
                    <h2 class="topic-name"
                        data-l-target-name
                        data-i-editable>
                        {{default topic.name "New topic"}}
                    </h2>
                </div>
                <div class="right">
                    <button class="accent block"
                            data-i-new="link">
                        Add link
                    </button>
                </div>
            </div>
            <div class="links"
                 data-o-key="links"
                 data-o-type="list"
                 data-i-sortable>{{#for link in topic.links}}
                <div class="{{#if ../../isPageAuthor}}fixed{{/if}} block link-item"
                     data-o-type="object"
                     data-l-key-label>
                    <div class="link-title"
                         data-l-target-label
                         data-i-editable>
                        {{default link.label "Article name"}}
                    </div>
                    <div class="link-url"
                         target="_blank"
                         data-o-type="object"
                         data-l-key-url
                         data-i-editable-without-remove>
                        {{default link.url "https://shelf.page/"}}
                    </div>
                    {{#if ../../isPageAuthor}}
                    {{else}}
                    <a class="link-url-button"
                       href="{{link.url}}"
                       target="_blank"
                       noopener noreferer>
                        read this &rarr;
                    </a>
                    {{/if}}
                </div>
            {{/for}}</div>
        </section>
        {{/for}}
    </div>

    <section>
        <div class="topic-header split">
            <h2 data-i-new="topic">
                + Add a topic section
            </h2>
        </div>
    </section>
</article>

